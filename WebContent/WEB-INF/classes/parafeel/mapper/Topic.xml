<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 
    <mapper namespace="parafeel.mapper.TopicMapper">
    	<resultMap id="TopicResultMap" type="parafeel.pojo.Topic" >
    		<id column="tId" property="tId" jdbcType="INTEGER" />
    		<result column="tName" property="tName" jdbcType="VARCHAR" />
    		<result column="tDetail" property="tDetail" jdbcType="VARCHAR" />
    		<result column="tMadeDate" property="tMadeDate" />
    		<result column="tQuestionCount" property="tQuestionCount" jdbcType="INTEGER" />
  		</resultMap>
  		<sql id="Topic_Column_List" >
    		tId, tName, tDetail, tMadeDate, tQuestionCount
  		</sql>
    	
    	<insert id="addTopic" parameterType="parafeel.pojo.Topic" >
            INSERT INTO topic (tId, tName, tDetail, tMadeDate, tQuestionCount) 
            	SELECT #{tId} ,#{tName} ,#{tDetail} ,#{tMadeDate},#{tQuestionCount}   
            	FROM DUAL WHERE NOT EXISTS(SELECT tName FROM user tName uEmail = #{tName}) 
        </insert>
         
        <delete id="deleteTopicById" parameterType="java.lang.Integer" >
            delete from topic where tId= #{tId}   
        </delete>
         
        <update id="updateTopicById" parameterType="parafeel.pojo.Topic" >
            update topic
		    <set >
		    	<if test="tName != null" >
		       		tName = #{tName,jdbcType=VARCHAR},
		     	</if>
		     	<if test="tDetail != null" >
		       		tDetail = #{tDetail,jdbcType=VARCHAR},
		     	</if>
		     	<if test="tQuestionCount != null" >
		     		tQuestionCount = #{tQuestionCount,jdbcType=INTEGER},
		     	</if>
		   	</set>
		   	where tId = #{tId,jdbcType=INTEGER}   
        </update>
         
        <select id="queryTopic" resultMap="TopicResultMap">
            SELECT <include refid="Topic_Column_List" /> FROM topic  
        </select>
  
    </mapper>